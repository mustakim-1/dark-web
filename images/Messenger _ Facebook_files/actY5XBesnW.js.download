;/*FB_PKG_DELIM*/

__d("MAWHandleEBRestoreWithHIM",["EchoMessage","MAWAckLevel","MAWDbChatId__UNSAFE_DO_NOT_USE","MAWHandleEchoMsgsRestoreApiUtils","MAWHandleEchoMsgsRestoreApiV2","MAWHandleEchoReactionsRestore","MAWJids","MAWMsgType","MAWProtocolQueueMsg","MAWProtocolQueueUtils","MAWSharedCOPLogger","MAWUnsafeCoerce","Promise","WAGlobals","WAJids","WAPREList","WAProtocolQueue","WAStanzaUtils","WATimeUtils","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Messages consumer: ",""]);i=function(){return a};return a}var j=new Set([d("EchoMessage").EchoMessageContentType.TEXT,d("EchoMessage").EchoMessageContentType.PLACEHOLDER]);function k(a){return c("gkx")("1645")&&j.has(a)}function l(a){if(a==="@me"||a==="@system")return d("WAGlobals").getMyUserJid();else return a}function m(a,b,c,e){var f=[];if(a.reactionXOfflineThreadingIds!=null)for(var g=0;g<a.reactionXOfflineThreadingIds.length;++g){var h=d("MAWHandleEchoReactionsRestore").getReactionsForReactionStore(b,c,null,e,a);h=h.map(function(a){return{decodedMsg:{unstoredDbMedia:void 0,unstoredDbMsg:void 0,unstoredDbReaction:a},stanza:p(a.externalId,a.ts,l(a.author),b,"reaction")}});f.push.apply(f,h)}return f}function n(a,b,c,e){return e?e.map(function(e){var f=e.messageId;return f!=null?{decodedMsg:{unstoredDbEditActionMsg:{ack:d("MAWAckLevel").ACK.sent,author:c,editMsgContent:{content:e.text},externalId:d("WAStanzaUtils").toStanzaId(f),originalMsgExternalId:a,serverTs:d("WATimeUtils").castToUnixTime(e.timestamp),ts:d("WATimeUtils").castToUnixTime(e.timestamp),type:d("MAWMsgType").MSG_TYPE.EDIT_ACTION},unstoredDbMedia:void 0,unstoredDbMsg:void 0,unstoredDbReaction:void 0},stanza:p(d("WAStanzaUtils").toStanzaId(f),d("WATimeUtils").castToUnixTime(e.timestamp),c,b,"text")}:null}).filter(Boolean):[]}function o(a,b){return a.map(function(a){var c,e=a.from,f=d("MAWHandleEchoMsgsRestoreApiV2").getDbMsgTypeFromEchoMessage(a);if(e==null||f==null)return null;f=d("WAStanzaUtils").toStanzaId(a.messageId);c=d("WATimeUtils").castToUnixTime(((c=a.authoritativeTimestampMs)!=null?c:a.sortOrderMs)/1e3);e=d("MAWJids").toUserJid(e.localKey);var g=r(a,b,d("WAStanzaUtils").toStanzaId(a.messageId));if(g==null)return null;var h=m(a,b,f,e),i=a.contentType===d("EchoMessage").EchoMessageContentType.TEXT||a.contentType===d("EchoMessage").EchoMessageContentType.PLACEHOLDER?"text":"media";a=n(f,b,e,a.editHistory);return[{decodedMsg:g,stanza:p(f,c,e,b,i)}].concat(h,a)}).filter(Boolean).flat()}function p(a,b,c,e,f){var g={icdc:null,metadata:null,protobuf:new Uint8Array(0),subprotocol:new Uint8Array(0),subprotocolType:"consumerMessage",type:"subprotocol",version:"v3"};g={device:{id:d("WAJids").DEFAULT_DEVICE_ID,identity:null},folder:null,id:{author:c,chat:e,externalId:a},msg:g,recipientsCount:null,reportingMeta:null,ts:b,type:"IncomingMsg"};return{consumerRetries:0,incomingType:"ebrestore",jid:e,message:{decrypted:g,details:{count:0,externalId:a,folder:void 0,from:d("WAJids").switchOnMsgrChatJidType(e,{group:function(a){return{author:d("WAJids").defaultDeviceJidForUser(c),chat:a,groupJid:a,type:"group"}},user:function(a){return{author:d("WAJids").defaultDeviceJidForUser(c),chat:a,deviceJid:d("WAJids").defaultDeviceJidForUser(c),type:"device"}}}),hideDecryptionFailure:!0,isInstamadillo:!1,offline:null,recipient:null,reportingMeta:null,retryCount:0,ts:b,type:f}},priority:d("WAProtocolQueue").WAProtocolQueuePriorityLow,stanzaId:a,stanzaQueueId:d("MAWUnsafeCoerce").unsafeCoerce(-1),type:"message"}}function q(a,b){return null}function r(a,b,c){c=d("MAWHandleEchoMsgsRestoreApiUtils").getUnstoredDbMessageFromEchoMessage(a,d("MAWDbChatId__UNSAFE_DO_NOT_USE").unsafeCoerceToChatId__DEPRECATED(-1),b,c);if(c==null)return null;c.originalTs;c.thread;c.threadJid;c.unsendMsgContentDeleteTs;c=babelHelpers.objectWithoutPropertiesLoose(c,["originalTs","thread","threadJid","unsendMsgContentDeleteTs"]);var e=a.contentType===d("EchoMessage").EchoMessageContentType.MEDIA||a.contentType===d("EchoMessage").EchoMessageContentType.XMA;return{unstoredDbMedia:e?q(a,b):void 0,unstoredDbMsg:c,unstoredDbReaction:void 0}}function a(a,b){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=[],g=[];a.forEach(function(a){k(a.contentType)?g.push(a):f.push(a)});if(g.length!==0){a=o(g,e).filter(Boolean);var j=a.map(function(a){return d("MAWProtocolQueueUtils").addMetricToMessage(a,d("WAPREList").PRE_METRIC.EB_RESTORE_WITH_HIM)}),l=(yield d("MAWProtocolQueueMsg").handleIncomingMessagesStanzas(j)["catch"](function(a){c("MAWSharedCOPLogger").TAGS(["EB_RESTORE_WITH_HIM"]).ERROR(i(),a);j.forEach(function(a){a=a.receiveFlow;a.endFail("consumer_handle_message_db_error")});return(h||(h=b("Promise"))).resolve()}));l!=null&&l.followUpParams.incomingMsgs.forEach(function(a){var b=l.followUpParams.incomingMsgResults.get(a.stanza.message.decrypted.id);(b==null?void 0:b.success)===!0?a.receiveFlow.endSuccess():a.receiveFlow.endFail((b=b==null?void 0:(a=b.error)==null?void 0:a.type)!=null?b:"unknown handle incoming msg error")})}return f});return s.apply(this,arguments)}g.isHandleEbRestoreWithHIM=k;g.restoreWithHIM=a}),98);
__d("MWDialogTextPairing.react",["MWDialogContentTypeValues","MWXTextPairing.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsx(c("MWXTextPairing.react"),babelHelpers["extends"]({},a,{level:d("MWDialogContentTypeValues").textPairingLevel}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWXTabs.react",["cr:4342","cr:4354","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){if(b("cr:4342")!=null)return i.jsx(b("cr:4342"),babelHelpers["extends"]({},a));return b("cr:4354")!=null?i.jsx(b("cr:4354"),babelHelpers["extends"]({},a)):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);